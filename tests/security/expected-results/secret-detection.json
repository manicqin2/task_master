{
  "version": "15.0.0",
  "scan": {
    "type": "secret_detection",
    "status": "success",
    "scanner": {
      "id": "gitleaks",
      "name": "Gitleaks"
    }
  },
  "vulnerabilities": [
    {
      "category": "secret_detection",
      "name": "AWS Access Key",
      "message": "Hardcoded AWS access key detected",
      "severity": "critical",
      "location": {
        "file": "tests/security/test-commits/secrets/aws-api-key.js",
        "start_line": 8
      },
      "solution": "Remove hardcoded AWS credentials. Use environment variables or AWS IAM roles instead."
    },
    {
      "category": "secret_detection",
      "name": "AWS Secret Key",
      "message": "Hardcoded AWS secret access key detected",
      "severity": "critical",
      "location": {
        "file": "tests/security/test-commits/secrets/aws-api-key.js",
        "start_line": 9
      },
      "solution": "Remove hardcoded AWS credentials. Use environment variables or AWS IAM roles instead."
    },
    {
      "category": "secret_detection",
      "name": "GitHub Token",
      "message": "Hardcoded GitHub personal access token detected",
      "severity": "critical",
      "location": {
        "file": "tests/security/test-commits/secrets/github-token.py",
        "start_line": 7
      },
      "solution": "Remove hardcoded GitHub token. Use environment variables or GitHub Apps for authentication."
    },
    {
      "category": "secret_detection",
      "name": "Generic Password",
      "message": "Hardcoded password detected",
      "severity": "high",
      "location": {
        "file": "tests/security/test-commits/secrets/password-leak.js",
        "start_line": 9
      },
      "solution": "Remove hardcoded password. Use environment variables or secure credential management systems."
    }
  ],
  "expected_behavior": {
    "aws-api-key.js": "MUST detect AWS access key and secret key",
    "github-token.py": "MUST detect GitHub personal access token",
    "password-leak.js": "MUST detect database password and API key",
    "false-positive.md": "SHOULD NOT detect documentation examples (after refactoring with .gitleaksignore)"
  }
}
